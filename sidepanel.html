<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Element Clip</title>
  <link rel="stylesheet" href="sidepanel.css">
</head>

<body>
  <div class="container">
    <!-- ヘッダー -->
    <header class="header">
      <h1 class="title">Element Clip</h1>
    </header>



    <!-- 変数リスト -->
    <section class="variables-section">
      <div class="section-header">
        <h2 class="section-title" style="margin-bottom: 0;">変数一覧</h2>
        <button id="btn-manage-templates" class="btn btn-small btn-secondary" title="構成テンプレート管理">
          📂 テンプレート
        </button>
      </div>

      <!-- アクションボタン -->
      <section class="actions">
        <button id="btn-add-variable" class="btn btn-primary">
          <span class="icon">➕</span>
          新しい変数を追加
        </button>
        <section class="action-group">
          <button id="btn-extract-all" class="btn btn-extract">
            <span class="icon">📥</span>
            一括抽出
          </button>
          <button id="btn-paste-all" class="btn btn-paste">
            <span class="icon">📤</span>
            一括貼り付け
          </button>
          <button id="btn-transform-all" class="btn btn-transform">
            <span class="icon">⚡</span>
            一括変換
          </button>
          <button id="btn-save-set" class="btn btn-primary" style="grid-column: span 3;">
            <span class="icon">💾</span>
            現在の変数をセットとして保存
          </button>
        </section>
      </section>

      <div id="variables-list" class="variables-list">
        <!-- 変数アイテムが動的に追加される -->
      </div>
      <div id="empty-state" class="empty-state">
        <p>まだ変数が登録されていません</p>
        <p class="empty-hint">「新しい変数を追加」ボタンから変数を作成してください</p>
      </div>
    </section>

    <!-- セット管理 -->
    <section class="sets-section">
      <div class="section-header">
        <h2 class="section-title">保存済みセット</h2>
        <div style="display: flex; gap: 4px;">
          <button id="btn-show-table" class="btn btn-small btn-secondary" title="一覧表示">
            <span class="icon">📊</span>
          </button>
          <div id="btn-delete-selected-sets" class="btn btn-small btn-danger" style="display: none;">
            <span class="icon">🗑️</span> 選択削除
          </div>
        </div>
      </div>
      <div id="sets-list" class="sets-list">
        <!-- セットアイテムが動的に追加される -->
      </div>
      <div id="sets-empty-state" class="empty-state">
        <p>保存済みセットはありません</p>
      </div>
    </section>

    <!-- 設定 -->
    <section class="settings-section">
      <h2 class="section-title">設定</h2>
      <div class="settings-item">
        <label>
          <input type="checkbox" id="setting-auto-highlight" checked>
          要素選択時に自動ハイライト
        </label>
      </div>
      <div class="settings-item">
        <label>
          <input type="checkbox" id="setting-show-notifications" checked>
          完了通知を表示
        </label>
      </div>
      <div class="settings-item">
        <label>
          <input type="checkbox" id="setting-clear-values">
          セット保存後に変数の値をクリア
        </label>
      </div>
    </section>
  </div>

  <!-- 変数追加/編集ダイアログ -->
  <div id="variable-dialog" class="dialog-overlay">
    <div class="dialog">
      <h3 class="dialog-title">変数の設定</h3>
      <div class="form-group group-basic">
        <label for="variable-name">変数名</label>
        <input type="text" id="variable-name" class="form-input" placeholder="例: ユーザー名">
      </div>
      <div class="section-title">抽出設定</div>
      <div class="form-group group-extract">
        <label for="variable-selector">抽出元CSSセレクタ</label>
        <div class="selector-group">
          <textarea id="variable-selector" class="form-textarea" placeholder="例: input#username" rows="2"></textarea>
          <div style="display: flex; flex-direction: column; gap: 4px;">
            <button id="btn-select-element" class="btn btn-secondary" data-target="extract">要素を選択</button>
            <button id="btn-verify-selector" class="btn btn-small btn-info" data-target="extract">セレクタ確認</button>
          </div>
        </div>
        <div class="selector-hint">セレクタを手動で編集することもできます</div>
      </div>
      <div class="form-group group-extract">
        <label for="variable-specificity">セレクタ詳細度レベル</label>
        <select id="variable-specificity" class="form-select">
          <option value="1" selected>レベル1 - 簡素</option>
          <option value="2">レベル2 - 詳細</option>
          <option value="3">レベル3 - 非常に詳細</option>
          <option value="4">レベル4 - 最大（完全パス）</option>
        </select>
        <div class="specificity-hint">
          レベルが高いほど特定的なセレクタが生成されます。
        </div>
      </div>
      <div class="form-group group-extract">
        <label for="variable-extract-type">抽出タイプ</label>
        <select id="variable-extract-type" class="form-select">
          <option value="value">value (input/select)</option>
          <option value="text" selected>text (テキスト内容)</option>
          <option value="attribute">attribute (属性値)</option>
          <option value="innerHTML">innerHTML</option>
        </select>
      </div>
      <div class="form-group group-extract" id="attribute-group" style="display: none;">
        <label for="variable-attribute-name">属性名</label>
        <input type="text" id="variable-attribute-name" class="form-input" placeholder="例: href, src">
      </div>

      <div class="separator"></div>

      <div class="section-title">貼付設定</div>
      <div class="form-group group-paste">
        <label for="variable-paste-selector">貼付先CSSセレクタ（任意）</label>
        <div class="selector-group">
          <textarea id="variable-paste-selector" class="form-textarea" placeholder="例: input#dest-input"
            rows="2"></textarea>
          <div style="display: flex; flex-direction: column; gap: 4px;">
            <button id="btn-select-paste-element" class="btn btn-secondary" data-target="paste">要素を選択</button>
            <button id="btn-verify-paste-selector" class="btn btn-small btn-info" data-target="paste">セレクタ確認</button>
          </div>
        </div>
        <div class="selector-hint">未設定の場合は、貼付ボタン押下時に要素を選択します</div>
      </div>
      <div class="form-group group-paste">
        <label for="variable-paste-specificity">貼り付け用セレクタ詳細度レベル</label>
        <select id="variable-paste-specificity" class="form-select">
          <option value="1" selected>レベル1 - 標準（推奨）</option>
          <option value="2">レベル2 - 詳細</option>
          <option value="3">レベル3 - 非常に詳細</option>
          <option value="4">レベル4 - 最大（完全パス）</option>
        </select>
      </div>

      <div class="section-title" style="font-size: 14px; margin-top: 16px; margin-bottom: 8px;">データ変換設定</div>
      <div class="form-row">
        <div class="form-group group-transform">
          <label for="variable-regex">正規表現パターン</label>
          <input type="text" id="variable-regex" class="form-input" placeholder="例: ^Price:\s*">
        </div>
        <div class="form-group group-transform">
          <label for="variable-regex-replacement">置換文字列</label>
          <input type="text" id="variable-regex-replacement" class="form-input" placeholder="例: $1">
        </div>
      </div>

      <div class="dialog-actions">
        <button id="btn-dialog-cancel" class="btn btn-secondary">キャンセル</button>
        <button id="btn-dialog-save" class="btn btn-primary">保存</button>
      </div>
    </div>
  </div>

  <!-- セット保存ダイアログ -->
  <div id="set-dialog" class="dialog-overlay">
    <div class="dialog">
      <h3 class="dialog-title">セットを保存</h3>
      <div class="form-group">
        <label for="set-name">セット名</label>
        <input type="text" id="set-name" class="form-input" placeholder="例: プロフィールデータ 2025/12/11">
      </div>
      <div class="dialog-actions">
        <button id="btn-set-cancel" class="btn btn-secondary">キャンセル</button>
        <button id="btn-set-save" class="btn btn-primary">保存</button>
      </div>
    </div>
  </div>

  <!-- テーブル表示ダイアログ -->
  <div id="table-dialog" class="dialog-overlay">
    <div class="dialog dialog-large">
      <div class="dialog-header">
        <h3 class="dialog-title">保存済みセット一覧</h3>
        <button id="btn-close-table" class="btn-close">×</button>
      </div>
      <div class="table-container">
        <table id="sets-table-content" class="data-table">
          <!-- JSで動的に生成 -->
        </table>
      </div>
    </div>
  </div>

  <!-- テンプレート管理ダイアログ -->
  <div id="template-dialog" class="dialog-overlay">
    <div class="dialog">
      <div class="dialog-header">
        <h3 class="dialog-title">変数構成テンプレート</h3>
        <button id="btn-close-template-dialog" class="btn-close">×</button>
      </div>

      <div class="form-group">
        <label>現在の構成を保存</label>
        <div style="display: flex; gap: 8px;">
          <input type="text" id="template-name-input" class="form-input" placeholder="テンプレート名">
          <button id="btn-save-template" class="btn btn-primary" style="white-space: nowrap;">保存</button>
        </div>
      </div>

      <div class="section-title" style="font-size: 14px; margin-top: 16px;">保存済みテンプレート</div>
      <div id="templates-list" style="max-height: 200px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px;">
        <!-- JSで生成 -->
      </div>
    </div>
  </div>

  <script src="utils.js"></script>
  <script src="store.js"></script>
  <script src="ui-variables.js"></script>
  <script src="ui-sets.js"></script>
  <script src="ui-templates.js"></script>
  <script src="sidepanel.js"></script>
</body>

</html>